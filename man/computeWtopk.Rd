% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/deconv.R
\name{computeWtopk}
\alias{computeWtopk}
\title{computeWtopk}
\usage{
computeWtopk(sp.obj, hot.pvals, num.cells, p.cut = 0.05)
}
\arguments{
\item{sp.obj}{Seurat object containing the spots.}

\item{hot.pvals}{Numeric matrix/data frame of p-values with rows = spots and columns = features.}

\item{num.cells}{Named integer/numeric vector giving, for each spot, the number of cells in that spot (the k used for Top-k).}

\item{p.cut}{Numeric scalar in (0, 1]; only p-values ≤ this threshold are eligible for the Top-k selection within each spot. Default: 0.05.}
}
\value{
A numeric matrix \code{w} of size (#clusters × #features). Each row (cluster) sums to 1
}
\description{
Compute cluster-level weights after per-spot Top-k selection with a p-value cutoff.
}
